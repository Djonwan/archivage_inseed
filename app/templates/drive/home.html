<!-- app/templates/drive/home.html -->
{% extends "base.html" %}
{% block title %}Accueil - Mon Drive{% endblock %}

{% block content %}

  <!-- TITRE FIXÉ EN HAUT -->
  <div class="sticky-top bg-white border-bottom pb-2" style="top: 70px; z-index: 998;">
    <div class="container-fluid d-flex justify-content-between align-items-center">
      <h2 class="fw-bold mb-0">Bienvenue au archivage des données</h2>
    </div>
  </div>

  <!-- SECTION HÉROS -->
  <div class="container mt-5">
    <div class="row g-4">
      <div class="col-md-4">
        <div class="hero-card">
          <img src="{{ url_for('static', filename='img/dossier-bureau.jpg') }}" alt="Archivage 1">
          <div class="title-banner">Archivage des documents/données</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="hero-card">
          <img src="{{ url_for('static', filename='img/business.jpg') }}" alt="Archivage 2">
          <div class="title-banner">Partage & Sécurité</div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="hero-card">
          <img src="{{ url_for('static', filename='img/ordinateur.avif') }}" alt="Archivage 3">
          <div class="title-banner">Recherche Intelligente</div>
        </div>
      </div>
    </div>
  </div>

  <!-- MES DOSSIERS -->
  <div class="container mt-5">
    <h3 class="mb-4">
      <i class="bi bi-folder me-2"></i>Mes dossiers
    </h3>

    {% if folders %}
      <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-4">
        {% for folder in folders %}
          {% set is_personal = folder.is_personal %}

          <div class="col">
            <a href="{{ url_for('drive.folder', folder_id=folder.id) }}"
               class="text-decoration-none">
              <div class="card h-100 shadow-sm hover-elevate border-0 position-relative
                          {% if is_personal %}border-start border-warning border-5{% else %}border-start border-primary border-5{% endif %}">
                
                <!-- Badge en haut à droite -->
                <div class="position-absolute top-0 end-0 p-2 z-3">
                  <span class="badge rounded-pill fs-7 px-3 py-2
                               {% if is_personal %}bg-warning text-dark{% else %}bg-primary text-white{% endif %}">
                    {% if is_personal %}
                      <i class="bi bi-person-lock"></i> Personnel
                    {% else %}
                      <i class="bi bi-share-fill"></i> Partagé
                    {% endif %}
                  </span>
                </div>

                <div class="card-body text-center p-4 d-flex flex-column justify-content-center">
                  <i class="bi bi-folder-fill mb-3
                             {% if is_personal %}text-warning{% else %}text-primary{% endif %}"
                     style="font-size: 3rem;"></i>
                  
                  <div class="fw-bold text-dark mb-1" style="font-size: 1rem;">
                    {{ folder.name }}
                  </div>
                  
                  <div class="text-muted small">
                    {{ folder.created_at.strftime('%d/%m/%Y') }}
                  </div>

                  {% if folder.description_folder %}
                    <div class="text-secondary small mt-2 text-truncate" style="max-width: 100%;">
                      <em>{{ folder.description_folder[:50] }}{% if folder.description_folder|length > 50 %}...{% endif %}</em>
                    </div>
                  {% endif %}
                </div>
              </div>
            </a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-5 text-muted">
        <i class="bi bi-folder text-warning" style="font-size: 4rem; opacity: 0.6;"></i>
        <p class="mt-4 fs-5">Vous n'avez créé aucun dossier pour le moment.</p>
        <a href="{{ url_for('drive.create_folder') }}" class="btn btn-primary btn-lg mt-3">
          <i class="bi bi-plus-circle"></i> Créer mon premier dossier
        </a>
      </div>
    {% endif %}
  </div>

{% endblock %}